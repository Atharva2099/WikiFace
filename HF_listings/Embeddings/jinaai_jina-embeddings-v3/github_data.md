# GitHub Data for jinaai_jina-embeddings-v3

**Task Category:** Embeddings

## Repository 1: Dao-AILab/flash-attention

# GitHub Repository Data

**Repository:** [Dao-AILab/flash-attention](https://github.com/Dao-AILab/flash-attention)

## Basic Information

- **Description:** Fast and memory-efficient exact attention
- **Created:** 2022-05-19T21:22:06+00:00
- **Last Updated:** 2025-06-21T22:24:20+00:00
- **Last Pushed:** 2025-06-21T12:43:59+00:00
- **Default Branch:** main
- **Size:** 9681 KB

## Statistics

- **Stars:** 17,958
- **Forks:** 1,760
- **Watchers:** 17,958
- **Open Issues:** 819
- **Total Issues:** 0
- **Pull Requests:** 298

## License

- **Type:** BSD 3-Clause "New" or "Revised" License
- **SPDX ID:** BSD-3-Clause
- **URL:** [License](https://github.com/Dao-AILab/flash-attention/blob/main/LICENSE)

## Languages

- **Python:** 2,433,439 bytes
- **C++:** 1,489,551 bytes
- **Cuda:** 507,220 bytes
- **Dockerfile:** 4,099 bytes
- **C:** 3,112 bytes
- **Makefile:** 126 bytes

## Top Contributors

1. **tridao** - 674 contributions
2. **piercefreeman** - 25 contributions
3. **ksivaman** - 18 contributions
4. **ipiszy** - 17 contributions
5. **DanFu09** - 11 contributions
6. **rocking5566** - 8 contributions
7. **drisspg** - 6 contributions
8. **danthe3rd** - 6 contributions
9. **jayhshah** - 5 contributions
10. **tmm1** - 5 contributions

## File Structure (Sample of 10 files)

Total files: 1,052

- `.github` (tree)
- `.github/workflows` (tree)
- `.github/workflows/publish.yml` (blob)
- `.gitignore` (blob)
- `.gitmodules` (blob)
- `AUTHORS` (blob)
- `LICENSE` (blob)
- `MANIFEST.in` (blob)
- `Makefile` (blob)
- `README.md` (blob)

## Recent Issues

- 游릭 **#1724** Wheel `cu12torch2.6` depends on torch2.7 (open)
- 游댮 **#1723** Fix(hopper): Correct C++ syntax in epilogue_fwd.hpp (closed)
- 游릭 **#1722** cute-dsl for sm90 backward (open)
- 游댮 **#1721** How to install csrc/layer_norm (dropout_layer_norm) on ROCM? (closed)
- 游댮 **#1720** Small page size support was removed? (closed)

## Recent Pull Requests

- 游댮 **#1723** Fix(hopper): Correct C++ syntax in epilogue_fwd.hpp (closed)
- 游댮 **#1719** fix: add tile shape to copy op template args (closed)
- 游릭 **#1716** Windows compile fix for MSVC (open)
- 游릭 **#1703** Theoretically make compiling from pip quicker (open)
- 游댮 **#1700** [fa3] API default values + backward compatibility (closed)

## Recent Commits

- **3ba6f826** Fix(hopper): Correct C++ syntax in epilogue_fwd.hpp (#1723) - Quentin Fitte-Rey (2025-06-21T12:43:59+00:00)
- **32c491f8** fix: add tile shape to copy op template args (#1719) - Rafael Celente (2025-06-16T23:29:15+00:00)
- **14bfeb37** [Cute] Use NameBarrier, replace cute.elem_less - Tri Dao (2025-06-15T01:05:49+00:00)
- **de79b136** [CI] Build with NVCC_THREADS=2 to avoid OOM - Tri Dao (2025-06-14T15:40:13+00:00)
- **71f7ac25** [CI] Compile with ubuntu-22.04 instead of ubuntu-20.04 - Tri Dao (2025-06-14T12:52:37+00:00)
- **6f8f0406** Bump to v2.8.0 - Tri Dao (2025-06-14T05:39:18+00:00)
- **d7383036** Update Cutlass to 4.0 - Tri Dao (2025-06-14T05:20:29+00:00)
- **d417a5b8** [CI] Compile with nvcc 12.9.0 - Tri Dao (2025-06-14T05:15:25+00:00)
- **d31da73b** [Cute] Implement PackGQA for attn fwd Sm90 - Tri Dao (2025-06-14T04:38:14+00:00)
- **a737ade3** [Cute] Use TMA for O when not varlen - Tri Dao (2025-06-10T15:50:51+00:00)

## External Links Found in README

- https://mistral.ai/news/announcing-mistral-7b/
- https://github.com/Dao-AILab/flash-attention/tree/main/training
- https://tridao.me/blog/2024/flash3/
- https://spectrum.ieee.org/mlperf-rankings-2022
- https://github.com/openai/triton/blob/master/python/tutorials/06-fused-attention.py
- https://hub.docker.com/r/rocm/pytorch
- https://mistral.ai/
- https://tridao.me/publications/flash2/flash2.pdf
- https://arxiv.org/abs/2205.14135
- https://tridao.me/publications/flash3/flash3.pdf
- https://github.com/triton-lang/triton
- https://github.com/Dao-AILab/flash-attention/issues/595
- https://github.com/ROCm/composable_kernel
- https://arxiv.org/abs/2309.06180
- https://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/modules/mha.py
- https://github.com/Dao-AILab/flash-attention/blob/main/usage.md
- https://github.com/ROCm/flash-attention.git
- https://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/flash_attn_triton.py
- https://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/models/gpt.py
- https://catalog.ngc.nvidia.com/orgs/nvidia/containers/pytorch

## Raw Data

<details>
<summary>Click to expand raw JSON data</summary>

```json
{
  "id": 494232964,
  "name": "flash-attention",
  "full_name": "Dao-AILab/flash-attention",
  "description": "Fast and memory-efficient exact attention",
  "html_url": "https://github.com/Dao-AILab/flash-attention",
  "clone_url": "https://github.com/Dao-AILab/flash-attention.git",
  "ssh_url": "git@github.com:Dao-AILab/flash-attention.git",
  "homepage": "",
  "topics": [],
  "default_branch": "main",
  "created_at": "2022-05-19T21:22:06+00:00",
  "updated_at": "2025-06-21T22:24:20+00:00",
  "pushed_at": "2025-06-21T12:43:59+00:00",
  "size_kb": 9681,
  "watchers_count": 17958,
  "stargazers_count": 17958,
  "forks_count": 1760,
  "open_issues_count": 819,
  "license": {
    "key": "bsd-3-clause",
    "name": "BSD 3-Clause \"New\" or \"Revised\" License",
    "spdx_id": "BSD-3-Clause",
    "url": "https://github.com/Dao-AILab/flash-attention/blob/main/LICENSE"
  },
  "languages": {
    "Python": 2433439,
    "C++": 1489551,
    "Cuda": 507220,
    "Dockerfile": 4099,
    "C": 3112,
    "Makefile": 126
  },
  "top_contributors": [
    {
      "login": "tridao",
      "contributions": 674
    },
    {
      "login": "piercefreeman",
      "contributions": 25
    },
    {
      "login": "ksivaman",
      "contributions": 18
    },
    {
      "login": "ipiszy",
      "contributions": 17
    },
    {
      "login": "DanFu09",
      "contributions": 11
    },
    {
      "login": "rocking5566",
      "contributions": 8
    },
    {
      "login": "drisspg",
      "contributions": 6
    },
    {
      "login": "danthe3rd",
      "contributions": 6
    },
    {
      "login": "jayhshah",
      "contributions": 5
    },
    {
      "login": "tmm1",
      "contributions": 5
    },
    {
      "login": "lucidrains",
      "contributions": 4
    },
    {
      "login": "lxuechen",
      "contributions": 4
    },
    {
      "login": "robotcator",
      "contributions": 4
    },
    {
      "login": "sgrigory",
      "contributions": 4
    },
    {
      "login": "kadeng",
      "contributions": 3
    },
    {
      "login": "philipturner",
      "contributions": 3
    },
    {
      "login": "kevinhu",
      "contributions": 3
    },
    {
      "login": "fedebotu",
      "contributions": 3
    },
    {
      "login": "bob80333",
      "contributions": 3
    },
    {
      "login": "ploshkin",
      "contributions": 3
    }
  ],
  "file_tree_count": 1052,
  "file_tree_sample": [
    {
      "path": ".github",
      "type": "tree"
    },
    {
      "path": ".github/workflows",
      "type": "tree"
    },
    {
      "path": ".github/workflows/publish.yml",
      "type": "blob"
    },
    {
      "path": ".gitignore",
      "type": "blob"
    },
    {
      "path": ".gitmodules",
      "type": "blob"
    },
    {
      "path": "AUTHORS",
      "type": "blob"
    },
    {
      "path": "LICENSE",
      "type": "blob"
    },
    {
      "path": "MANIFEST.in",
      "type": "blob"
    },
    {
      "path": "Makefile",
      "type": "blob"
    },
    {
      "path": "README.md",
      "type": "blob"
    }
  ],
  "issues_count": 0,
  "pulls_count": 298,
  "recent_issues": [
    {
      "number": 1724,
      "title": "Wheel `cu12torch2.6` depends on torch2.7",
      "state": "open"
    },
    {
      "number": 1723,
      "title": "Fix(hopper): Correct C++ syntax in epilogue_fwd.hpp",
      "state": "closed"
    },
    {
      "number": 1722,
      "title": "cute-dsl for sm90 backward",
      "state": "open"
    },
    {
      "number": 1721,
      "title": "How to install csrc/layer_norm (dropout_layer_norm) on ROCM?",
      "state": "closed"
    },
    {
      "number": 1720,
      "title": "Small page size support was removed?",
      "state": "closed"
    }
  ],
  "recent_pulls": [
    {
      "number": 1723,
      "title": "Fix(hopper): Correct C++ syntax in epilogue_fwd.hpp",
      "state": "closed"
    },
    {
      "number": 1719,
      "title": "fix: add tile shape to copy op template args",
      "state": "closed"
    },
    {
      "number": 1716,
      "title": "Windows compile fix for MSVC",
      "state": "open"
    },
    {
      "number": 1703,
      "title": "Theoretically make compiling from pip quicker",
      "state": "open"
    },
    {
      "number": 1700,
      "title": "[fa3] API default values + backward compatibility",
      "state": "closed"
    }
  ],
  "recent_commits": [
    {
      "sha": "3ba6f826b199ff68aa9e9139a46280160defa5cd",
      "author": "Quentin Fitte-Rey",
      "date": "2025-06-21T12:43:59+00:00",
      "message": "Fix(hopper): Correct C++ syntax in epilogue_fwd.hpp (#1723)"
    },
    {
      "sha": "32c491f8c592650c38374545738f589cc3b73c5f",
      "author": "Rafael Celente",
      "date": "2025-06-16T23:29:15+00:00",
      "message": "fix: add tile shape to copy op template args (#1719)"
    },
    {
      "sha": "14bfeb371d42d2d13759ea76e51080a569a4d484",
      "author": "Tri Dao",
      "date": "2025-06-15T01:05:49+00:00",
      "message": "[Cute] Use NameBarrier, replace cute.elem_less"
    },
    {
      "sha": "de79b1361e0e6ade09b9b5ca3949cc088eee9965",
      "author": "Tri Dao",
      "date": "2025-06-14T15:40:13+00:00",
      "message": "[CI] Build with NVCC_THREADS=2 to avoid OOM"
    },
    {
      "sha": "71f7ac258ac193bf2cecd2c82a0d6e22bcba157f",
      "author": "Tri Dao",
      "date": "2025-06-14T12:52:37+00:00",
      "message": "[CI] Compile with ubuntu-22.04 instead of ubuntu-20.04"
    },
    {
      "sha": "6f8f0406eea522735d590c2d7b46139167b95b6e",
      "author": "Tri Dao",
      "date": "2025-06-14T05:39:18+00:00",
      "message": "Bump to v2.8.0"
    },
    {
      "sha": "d7383036b3922ccba57f94652d21666a62a0023c",
      "author": "Tri Dao",
      "date": "2025-06-14T05:20:29+00:00",
      "message": "Update Cutlass to 4.0"
    },
    {
      "sha": "d417a5b86b3778056a71c396161558566862f2c3",
      "author": "Tri Dao",
      "date": "2025-06-14T05:15:25+00:00",
      "message": "[CI] Compile with nvcc 12.9.0"
    },
    {
      "sha": "d31da73bc3999da9bc3320c0bcd41ac8aa0d8e3e",
      "author": "Tri Dao",
      "date": "2025-06-14T04:38:14+00:00",
      "message": "[Cute] Implement PackGQA for attn fwd Sm90"
    },
    {
      "sha": "a737ade30f3074657ab31d0659da3a6f2d099ed2",
      "author": "Tri Dao",
      "date": "2025-06-10T15:50:51+00:00",
      "message": "[Cute] Use TMA for O when not varlen"
    },
    {
      "sha": "9a79170f72eced9f4f12a22609316f6d058b1071",
      "author": "Tri Dao",
      "date": "2025-06-10T02:09:15+00:00",
      "message": "[Cute] Implement varlen_q and varlen_q for attn fwd Sm90"
    },
    {
      "sha": "8ede0362f967a5c37136f85cc391590217f84f42",
      "author": "Tri Dao",
      "date": "2025-06-09T16:48:02+00:00",
      "message": "[Cute] Refactor Softmax and BlockInfo objects"
    },
    {
      "sha": "69133f8aba8bfff1fd48d73ca40ebeb6424c369e",
      "author": "Tri Dao",
      "date": "2025-06-09T02:21:51+00:00",
      "message": "[Cute] Use TMA to store O in attn fwd epilogue"
    },
    {
      "sha": "c8569124da23116dec845c78cbc2643390464b25",
      "author": "Tri Dao",
      "date": "2025-06-08T20:54:03+00:00",
      "message": "[Cute] Refactor a bit"
    },
    {
      "sha": "14b0fec2a4b392076bbad2e907aea956713c2dff",
      "author": "Tri Dao",
      "date": "2025-06-08T20:10:34+00:00",
      "message": "[Cute] Implement intra-warpgroup overlap for attn fwd on Sm90"
    },
    {
      "sha": "847025a0028eff7180304d0ca07b318bf13ff61a",
      "author": "dan_the_3rd",
      "date": "2025-06-08T04:59:22+00:00",
      "message": "[fa3] API default values + backward compatibility (#1700)"
    },
    {
      "sha": "fc27c4f6aa2939ca609a508d6d535f04c03bc62f",
      "author": "dan_the_3rd",
      "date": "2025-06-08T04:58:49+00:00",
      "message": "[fa3] Some fixes for windows build (#1698)"
    },
    {
      "sha": "36375164680e19d2af0950af3c5003f3ab41ca6d",
      "author": "Tri Dao",
      "date": "2025-06-08T03:52:12+00:00",
      "message": "[Cute] Use consumer_try_wait before consumer_wait"
    },
    {
      "sha": "2d8635cb777af10860431f9b7213e5b0ad6cfa0d",
      "author": "Tri Dao",
      "date": "2025-06-08T03:41:23+00:00",
      "message": "[Cute] Implement PipelineTmaAsyncNoCluster"
    },
    {
      "sha": "d3d95dc5c0c7fe7eae2e91780e69f559d786a8ad",
      "author": "Tri Dao",
      "date": "2025-06-07T22:17:40+00:00",
      "message": "[Cute] Implement inter-warpgroup overlap"
    }
  ],
  "readme_text": "# FlashAttention\nThis repository provides the official implementation of FlashAttention and\nFlashAttention-2 from the\nfollowing papers.\n\n**FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness**  \nTri Dao, Daniel Y. Fu, Stefano Ermon, Atri Rudra, Christopher R\u00e9  \nPaper: https://arxiv.org/abs/2205.14135  \nIEEE Spectrum [article](https://spectrum.ieee.org/mlperf-rankings-2022) about our submission to the MLPerf 2.0 benchmark using FlashAttention.\n![FlashAttention](assets/flashattn_banner.jpg)\n\n**FlashAttention-2: Faster Attention with Better Parallelism and Work Partitioning**  \nTri Dao\n\nPaper: https://tridao.me/publications/flash2/flash2.pdf\n\n![FlashAttention-2](assets/flashattention_logo.png)\n\n\n## Usage\n\nWe've been very happy to see FlashAttention being widely adopted in such a short\ntime after its release. This [page](https://github.com/Dao-AILab/flash-attention/blob/main/usage.md)\ncontains a partial list of places where FlashAttention is being used.\n\nFlashAttention and FlashAttention-2 are free to use and modify (see LICENSE).\nPlease cite and credit FlashAttention if you use it.\n\n\n## FlashAttention-3 beta release\nFlashAttention-3 is optimized for Hopper GPUs (e.g. H100). \n\nBlogpost: https://tridao.me/blog/2024/flash3/\n\nPaper: https://tridao.me/publications/flash3/flash3.pdf\n\n![FlashAttention-3 speedup on H100 80GB SXM5 with FP16](assets/flash3_fp16_fwd.png)\n\nThis is a beta release for testing / benchmarking before we integrate that with\nthe rest of the repo.\n\nCurrently released:\n- FP16 / BF16 forward and backward, FP8 forward\n\nRequirements: H100 / H800 GPU, CUDA >= 12.3.\n\nWe highly recommend CUDA 12.8 for best performance.\n\nTo install:\n```sh\ncd hopper\npython setup.py install\n```\nTo run the test:\n```sh\nexport PYTHONPATH=$PWD\npytest -q -s test_flash_attn.py\n```\nOnce the package is installed, you can import it as follows:\n```python\nimport flash_attn_interface\nflash_attn_interface.flash_attn_func()\n```\n\n## Installation and features\n**Requirements:**\n- CUDA toolkit or ROCm toolkit\n- PyTorch 2.2 and above.\n- `packaging` Python package (`pip install packaging`)\n- `ninja` Python package (`pip install ninja`) *\n- Linux. Might work for Windows starting v2.3.2 (we've seen a few positive [reports](https://github.com/Dao-AILab/flash-attention/issues/595)) but Windows compilation still requires more testing. If you have ideas on how to set up prebuilt CUDA wheels for Windows, please reach out via Github issue.\n\n\\* Make sure that `ninja` is installed and that it works correctly (e.g. `ninja\n--version` then `echo $?` should return exit code 0). If not (sometimes `ninja\n--version` then `echo $?` returns a nonzero exit code), uninstall then reinstall\n`ninja` (`pip uninstall -y ninja && pip install ninja`). Without `ninja`,\ncompiling can take a very long time (2h) since it does not use multiple CPU\ncores. With `ninja` compiling takes 3-5 minutes on a 64-core machine using CUDA toolkit.\n\n**To install:**\n```sh\npip install flash-attn --no-build-isolation\n```\nAlternatively you can compile from source:\n```sh\npython setup.py install\n```\n\nIf your machine has less than 96GB of RAM and lots of CPU cores, `ninja` might\nrun too many parallel compilation jobs that could exhaust the amount of RAM. To\nlimit the number of parallel compilation jobs, you can set the environment\nvariable `MAX_JOBS`:\n```sh\nMAX_JOBS=4 pip install flash-attn --no-build-isolation\n```\n\n**Interface:** `src/flash_attention_interface.py`\n\n### NVIDIA CUDA Support\n**Requirements:**\n- CUDA 12.0 and above.\n\nWe recommend the\n[Pytorch](https://catalog.ngc.nvidia.com/orgs/nvidia/containers/pytorch)\ncontainer from Nvidia, which has all the required tools to install FlashAttention.\n\nFlashAttention-2 with CUDA currently supports:\n1. Ampere, Ada, or Hopper GPUs (e.g., A100, RTX 3090, RTX 4090, H100). Support for Turing\n   GPUs (T4, RTX 2080) is coming soon, please use FlashAttention 1.x for Turing\n   GPUs for now.\n2. Datatype fp16 and bf16 (bf16 requires Ampere, Ada, or Hopper GPUs).\n3. All head dimensions up to 256. ~~Head dim > 192 backward requires A100/A800 or H100/H800~~. Head dim 256 backward now works on consumer GPUs (if there's no dropout) as of flash-attn 2.5.5.\n\n### AMD ROCm Support\nROCm version has two backends. There is [composable_kernel](https://github.com/ROCm/composable_kernel) (ck) which is the default backend and a [Triton](https://github.com/triton-lang/triton) backend. They provide an implementation of FlashAttention-2.\n\n**Requirements:**\n- ROCm 6.0 and above.\n\nWe recommend the\n[Pytorch](https://hub.docker.com/r/rocm/pytorch)\ncontainer from ROCm, which has all the required tools to install FlashAttention.\n\n#### Composable Kernel Backend\nFlashAttention-2 ROCm CK backend currently supports:\n1. MI200 or MI300 GPUs.\n2. Datatype fp16 and bf16\n3. Both forward's and backward's head dimensions up to 256.\n\n#### Triton Backend\nThe Triton implementation of the [Flash Attention v2](https://tridao.me/publications/flash2/flash2.pdf) is currently a work in progress.\n\nIt supports AMD's CDNA (MI200, MI300) and RDNA GPU's using fp16, bf16 and fp32 datatypes.\n\nThese features are supported in Fwd and Bwd\n1) Fwd and Bwd with causal masking\n2) Variable sequence lengths\n3) Arbitrary Q and KV sequence lengths\n4) Arbitrary head sizes\n5) Multi and grouped query attention\n6) Dropout\n7) Rotary embeddings\n8) ALiBi\n\nWe are working on the following things\n1) Paged Attention \n2) Sliding Window\n3) FP8\n4) Performance Improvements\n\n##### Getting Started\nTo get started with the triton backend for AMD, follow the steps below.\n\nFirst install the recommended Triton version \n\n```\npip install triton==3.2.0\n```\nThen install Flash Attention with the flag `FLASH_ATTENTION_TRITON_AMD_ENABLE` set to `\"TRUE\"`.\n\n```\ncd flash-attention\ngit checkout main_perf\nFLASH_ATTENTION_TRITON_AMD_ENABLE=\"TRUE\" python setup.py install\n```\n\nTo test that things are working, you can run our tests. These tests take hours so you don't need to run the full thing.\n```\nFLASH_ATTENTION_TRITON_AMD_ENABLE=\"TRUE\" pytest tests/test_flash_attn_triton_amd.py\n```\n\nYou can use autotune for better performance by using this flag `FLASH_ATTENTION_TRITON_AMD_AUTOTUNE=\"TRUE\"`\n```\nFLASH_ATTENTION_TRITON_AMD_ENABLE=\"TRUE\" FLASH_ATTENTION_TRITON_AMD_AUTOTUNE=\"TRUE\" python $PATH_TO_CODE\n```\n\n###### Docker\nYou can also use the Dockerfile below which does the above steps on top of the latest rocm/pytorch image.\n```\nFROM rocm/pytorch:latest\n\nWORKDIR /workspace\n\n# install triton\nRUN pip install triton==3.2.0\n\n# install flash attention\nENV FLASH_ATTENTION_TRITON_AMD_ENABLE=\"TRUE\"\n\nRUN git clone https://github.com/ROCm/flash-attention.git &&\\ \n    cd flash-attention &&\\\n    git checkout main_perf &&\\\n    python setup.py install\n\n# set working dir\nWORKDIR /workspace/flash-attention\n```\n\nTo build the docker file\n```\ndocker build -t fa_triton .\n```\n\nTo run the docker image\n```\ndocker run -it --network=host --user root --group-add video --cap-add=SYS_PTRACE --security-opt seccomp=unconfined --ipc=host --shm-size 16G --device=/dev/kfd --device=/dev/dri fa_triton\n```\n\n## How to use FlashAttention\n\nThe main functions implement scaled dot product attention (softmax(Q @ K^T *\nsoftmax_scale) @ V):\n```python\nfrom flash_attn import flash_attn_qkvpacked_func, flash_attn_func\n```\n\n```python\nflash_attn_qkvpacked_func(qkv, dropout_p=0.0, softmax_scale=None, causal=False,\n                          window_size=(-1, -1), alibi_slopes=None, deterministic=False):\n\"\"\"dropout_p should be set to 0.0 during evaluation\nIf Q, K, V are already stacked into 1 tensor, this function will be faster than\ncalling flash_attn_func on Q, K, V since the backward pass avoids explicit concatenation\nof the gradients of Q, K, V.\nIf window_size != (-1, -1), implements sliding window local attention. Query at position i\nwill only attend to keys between [i - window_size[0], i + window_size[1]] inclusive.\nArguments:\n    qkv: (batch_size, seqlen, 3, nheads, headdim)\n    dropout_p: float. Dropout probability.\n    softmax_scale: float. The scaling of QK^T before applying softmax.\n        Default to 1 / sqrt(headdim).\n    causal: bool. Whether to apply causal attention mask (e.g., for auto-regressive modeling).\n    window_size: (left, right). If not (-1, -1), implements sliding window local attention.\n    alibi_slopes: (nheads,) or (batch_size, nheads), fp32. A bias of (-alibi_slope * |i - j|) is added to\n        the attention score of query i and key j.\n    deterministic: bool. Whether to use the deterministic implementation of the backward pass,\n        which is slightly slower and uses more memory. The forward pass is always deterministic.\nReturn:\n    out: (batch_size, seqlen, nheads, headdim).\n\"\"\"\n```\n\n```python\nflash_attn_func(q, k, v, dropout_p=0.0, softmax_scale=None, causal=False,\n                window_size=(-1, -1), alibi_slopes=None, deterministic=False):\n\"\"\"dropout_p should be set to 0.0 during evaluation\nSupports multi-query and grouped-query attention (MQA/GQA) by passing in KV with fewer heads\nthan Q. Note that the number of heads in Q must be divisible by the number of heads in KV.\nFor example, if Q has 6 heads and K, V have 2 heads, head 0, 1, 2 of Q will attention to head\n0 of K, V, and head 3, 4, 5 of Q will attention to head 1 of K, V.\nIf window_size != (-1, -1), implements sliding window local attention. Query at position i\nwill only attend to keys between\n[i + seqlen_k - seqlen_q - window_size[0], i + seqlen_k - seqlen_q + window_size[1]] inclusive.\n\nArguments:\n    q: (batch_size, seqlen, nheads, headdim)\n    k: (batch_size, seqlen, nheads_k, headdim)\n    v: (batch_size, seqlen, nheads_k, headdim)\n    dropout_p: float. Dropout probability.\n    softmax_scale: float. The scaling of QK^T before applying softmax.\n        Default to 1 / sqrt(headdim).\n    causal: bool. Whether to apply causal attention mask (e.g., for auto-regressive modeling).\n    window_size: (left, right). If not (-1, -1), implements sliding window local attention.\n    alibi_slopes: (nheads,) or (batch_size, nheads), fp32. A bias of\n        (-alibi_slope * |i + seqlen_k - seqlen_q - j|)\n        is added to the attention score of query i and key j.\n    deterministic: bool. Whether to use the deterministic implementation of the backward pass,\n        which is slightly slower and uses more memory. The forward pass is always deterministic.\nReturn:\n    out: (batch_size, seqlen, nheads, headdim).\n\"\"\"\n```\n\n```python\ndef flash_attn_with_kvcache(\n    q,\n    k_cache,\n    v_cache,\n    k=None,\n    v=None,\n    rotary_cos=None,\n    rotary_sin=None,\n    cache_seqlens: Optional[Union[(int, torch.Tensor)]] = None,\n    cache_batch_idx: Optional[torch.Tensor] = None,\n    block_table: Optional[torch.Tensor] = None,\n    softmax_scale=None,\n    causal=False,\n    window_size=(-1, -1),  # -1 means infinite context window\n    rotary_interleaved=True,\n    alibi_slopes=None,\n):\n    \"\"\"\n    If k and v are not None, k_cache and v_cache will be updated *inplace* with the new values from\n    k and v. This is useful for incremental decoding: you can pass in the cached keys/values from\n    the previous step, and update them with the new keys/values from the current step, and do\n    attention with the updated cache, all in 1 kernel.\n\n    If you pass in k / v, you must make sure that the cache is large enough to hold the new values.\n    For example, the KV cache could be pre-allocated with the max sequence length, and you can use\n    cache_seqlens to keep track of the current sequence lengths of each sequence in the batch.\n\n    Also apply rotary embedding if rotary_cos and rotary_sin are passed in. The key @k will be\n    rotated by rotary_cos and rotary_sin at indices cache_seqlens, cache_seqlens + 1, etc.\n    If causal or local (i.e., window_size != (-1, -1)), the query @q will be rotated by rotary_cos\n    and rotary_sin at indices cache_seqlens, cache_seqlens + 1, etc.\n    If not causal and not local, the query @q will be rotated by rotary_cos and rotary_sin at\n    indices cache_seqlens only (i.e. we consider all tokens in @q to be at position cache_seqlens).\n\n    See tests/test_flash_attn.py::test_flash_attn_kvcache for examples of how to use this function.\n\n    Supports multi-query and grouped-query attention (MQA/GQA) by passing in KV with fewer heads\n    than Q. Note that the number of heads in Q must be divisible by the number of heads in KV.\n    For example, if Q has 6 heads and K, V have 2 heads, head 0, 1, 2 of Q will attention to head\n    0 of K, V, and head 3, 4, 5 of Q will attention to head 1 of K, V.\n\n    If causal=True, the causal mask is aligned to the bottom right corner of the attention matrix.\n    For example, if seqlen_q = 2 and seqlen_k = 5, the causal mask (1 = keep, 0 = masked out) is:\n        1 1 1 1 0\n        1 1 1 1 1\n    If seqlen_q = 5 and seqlen_k = 2, the causal mask is:\n        0 0\n        0 0\n        0 0\n        1 0\n        1 1\n    If the row of the mask is all zero, the output will be zero.\n\n    If window_size != (-1, -1), implements sliding window local attention. Query at position i\n    will only attend to keys between\n    [i + seqlen_k - seqlen_q - window_size[0], i + seqlen_k - seqlen_q + window_size[1]] inclusive.\n\n    Note: Does not support backward pass.\n\n    Arguments:\n        q: (batch_size, seqlen, nheads, headdim)\n        k_cache: (batch_size_cache, seqlen_cache, nheads_k, headdim) if there's no block_table,\n            or (num_blocks, page_block_size, nheads_k, headdim) if there's a block_table (i.e. paged KV cache)\n            page_block_size must be a multiple of 256.\n        v_cache: (batch_size_cache, seqlen_cache, nheads_k, headdim) if there's no block_table,\n            or (num_blocks, page_block_size, nheads_k, headdim) if there's a block_table (i.e. paged KV cache)\n        k [optional]: (batch_size, seqlen_new, nheads_k, headdim). If not None, we concatenate\n            k with k_cache, starting at the indices specified by cache_seqlens.\n        v [optional]: (batch_size, seqlen_new, nheads_k, headdim). Similar to k.\n        rotary_cos [optional]: (seqlen_ro, rotary_dim / 2). If not None, we apply rotary embedding\n            to k and q. Only applicable if k and v are passed in. rotary_dim must be divisible by 16.\n        rotary_sin [optional]: (seqlen_ro, rotary_dim / 2). Similar to rotary_cos.\n        cache_seqlens: int, or (batch_size,), dtype torch.int32. The sequence lengths of the\n            KV cache.\n        block_table [optional]: (batch_size, max_num_blocks_per_seq), dtype torch.int32.\n        cache_batch_idx: (batch_size,), dtype torch.int32. The indices used to index into the KV cache.\n            If None, we assume that the batch indices are [0, 1, 2, ..., batch_size - 1].\n            If the indices are not distinct, and k and v are provided, the values updated in the cache\n                 might come from any of the duplicate indices.\n        softmax_scale: float. The scaling of QK^T before applying softmax.\n            Default to 1 / sqrt(headdim).\n        causal: bool. Whether to apply causal attention mask (e.g., for auto-regressive modeling).\n        window_size: (left, right). If not (-1, -1), implements sliding window local attention.\n        rotary_interleaved: bool. Only applicable if rotary_cos and rotary_sin are passed in.\n            If True, rotary embedding will combine dimensions 0 & 1, 2 & 3, etc. If False,\n            rotary embedding will combine dimensions 0 & rotary_dim / 2, 1 & rotary_dim / 2 + 1\n            (i.e. GPT-NeoX style).\n        alibi_slopes: (nheads,) or (batch_size, nheads), fp32. A bias of\n            (-alibi_slope * |i + seqlen_k - seqlen_q - j|)\n            is added to the attention score of query i and key j.\n\n    Return:\n        out: (batch_size, seqlen, nheads, headdim).\n    \"\"\"\n```\n\nTo see how these functions are used in a multi-head attention layer (which\nincludes QKV projection, output projection), see the MHA [implementation](https://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/modules/mha.py).\n\n## Changelog\n\n### 2.0: Complete rewrite, 2x faster\nUpgrading from FlashAttention (1.x) to FlashAttention-2\n\nThese functions have been renamed:\n- `flash_attn_unpadded_func` -> `flash_attn_varlen_func`\n- `flash_attn_unpadded_qkvpacked_func` -> `flash_attn_varlen_qkvpacked_func`\n- `flash_attn_unpadded_kvpacked_func` -> `flash_attn_varlen_kvpacked_func`\n\nIf the inputs have the same sequence lengths in the same batch, it is simpler\nand faster to use these functions:\n```python\nflash_attn_qkvpacked_func(qkv, dropout_p=0.0, softmax_scale=None, causal=False)\n```\n```python\nflash_attn_func(q, k, v, dropout_p=0.0, softmax_scale=None, causal=False)\n```\n### 2.1: Change behavior of causal flag\n\nIf seqlen_q != seqlen_k and causal=True, the causal mask is aligned to the\nbottom right corner of the attention matrix, instead of the top-left corner.\n\nFor example, if seqlen_q = 2 and seqlen_k = 5, the causal mask (1 = keep, 0 =\nmasked out) is:  \nv2.0:  \n    1 0 0 0 0  \n    1 1 0 0 0  \nv2.1:  \n    1 1 1 1 0  \n    1 1 1 1 1  \n\nIf seqlen_q = 5 and seqlen_k = 2, the causal mask is:  \nv2.0:  \n    1 0  \n    1 1  \n    1 1  \n    1 1  \n    1 1  \nv2.1:  \n    0 0  \n    0 0  \n    0 0  \n    1 0  \n    1 1  \nIf the row of the mask is all zero, the output will be zero.\n\n### 2.2: Optimize for inference\n\nOptimize for inference (iterative decoding) when query has very small sequence\nlength (e.g., query sequence length = 1). The bottleneck here is to load KV\ncache as fast as possible, and we split the loading across different thread\nblocks, with a separate kernel to combine results.\n\nSee the function `flash_attn_with_kvcache` with more features for inference\n(perform rotary embedding, updating KV cache inplace).\n\nThanks to the xformers team, and in particular Daniel Haziza, for this\ncollaboration.\n\n### 2.3: Local (i.e., sliding window) attention\n\nImplement sliding window attention (i.e., local attention). Thanks to [Mistral\nAI](https://mistral.ai/) and in particular Timoth\u00e9e Lacroix for this\ncontribution. Sliding window was used in the [Mistral 7B](https://mistral.ai/news/announcing-mistral-7b/) model.\n\n### 2.4: ALiBi (attention with linear bias), deterministic backward pass.\n\nImplement ALiBi (Press et al., 2021). Thanks to Sanghun Cho from Kakao Brain for this contribution.\n\nImplement deterministic backward pass. Thanks to engineers from [Meituan](www.meituan.com) for this contribution.\n\n### 2.5: Paged KV cache.\n\nSupport paged KV cache (i.e., [PagedAttention](https://arxiv.org/abs/2309.06180)).\nThanks to @beginlner for this contribution.\n\n### 2.6: Softcapping.\n\nSupport attention with softcapping, as used in Gemma-2 and Grok models.\nThanks to @Narsil and @lucidrains for this contribution.\n\n### 2.7: Compatibility with torch compile\n\nThanks to @ani300 for this contribution.\n\n## Performance\n\nWe present expected speedup (combined forward + backward pass) and memory savings from using FlashAttention against PyTorch standard attention, depending on sequence length, on different GPUs (speedup depends on memory bandwidth - we see more speedup on slower GPU memory).\n\nWe currently have benchmarks for these GPUs:\n* [A100](#a100)\n* [H100](#h100)\n<!-- * [RTX 3090](#rtx-3090) -->\n<!-- * [T4](#t4) -->\n\n### A100\n\nWe display FlashAttention speedup using these parameters:\n* Head dimension 64 or 128, hidden dimension 2048 (i.e. either 32 or 16 heads).\n* Sequence length 512, 1k, 2k, 4k, 8k, 16k.\n* Batch size set to 16k / seqlen.\n\n#### Speedup\n\n![FlashAttention speedup on A100 80GB SXM5 with FP16/BF16](assets/flash2_a100_fwd_bwd_benchmark.png)\n\n#### Memory\n\n![FlashAttention memory](assets/flashattn_memory.jpg)\n\nWe show memory savings in this graph (note that memory footprint is the same no matter if you use dropout or masking).\nMemory savings are proportional to sequence length -- since standard attention has memory quadratic in sequence length, whereas FlashAttention has memory linear in sequence length.\nWe see 10X memory savings at sequence length 2K, and 20X at 4K.\nAs a result, FlashAttention can scale to much longer sequence lengths.\n\n### H100\n\n![FlashAttention speedup on H100 SXM5 with FP16/BF16](assets/flash2_h100_fwd_bwd_benchmark.png)\n\n## Full model code and training script\n\nWe have released the full GPT model\n[implementation](https://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/models/gpt.py).\nWe also provide optimized implementations of other layers (e.g., MLP, LayerNorm,\ncross-entropy loss, rotary embedding). Overall this speeds up training by 3-5x\ncompared to the baseline implementation from Huggingface, reaching up to 225\nTFLOPs/sec per A100, equivalent to 72% model FLOPs utilization (we don't need\nany activation checkpointing).\n\nWe also include a training\n[script](https://github.com/Dao-AILab/flash-attention/tree/main/training) to\ntrain GPT2 on Openwebtext and GPT3 on The Pile.\n\n## Triton implementation of FlashAttention\n\nPhil Tillet (OpenAI) has an experimental implementation of FlashAttention in Triton:\nhttps://github.com/openai/triton/blob/master/python/tutorials/06-fused-attention.py\n\nAs Triton is a higher-level language than CUDA, it might be easier to understand\nand experiment with. The notations in the Triton implementation are also closer\nto what's used in our paper.\n\nWe also have an experimental implementation in Triton that support attention\nbias (e.g. ALiBi):\nhttps://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/flash_attn_triton.py\n\n\n## Tests\nWe test that FlashAttention produces the same output and gradient as a reference\nimplementation, up to some numerical tolerance. In particular, we check that the\nmaximum numerical error of FlashAttention is at most twice the numerical error\nof a baseline implementation in Pytorch (for different head dimensions, input\ndtype, sequence length, causal / non-causal).\n\nTo run the tests:\n```sh\npytest -q -s tests/test_flash_attn.py\n```\n## When you encounter issues\n\nThis new release of FlashAttention-2 has been tested on several GPT-style\nmodels, mostly on A100 GPUs.\n\nIf you encounter bugs, please open a GitHub Issue!\n\n## Tests\nTo run the tests:\n```sh\npytest tests/test_flash_attn_ck.py\n```\n\n## Citation\nIf you use this codebase, or otherwise found our work valuable, please cite:\n```\n@inproceedings{dao2022flashattention,\n  title={Flash{A}ttention: Fast and Memory-Efficient Exact Attention with {IO}-Awareness},\n  author={Dao, Tri and Fu, Daniel Y. and Ermon, Stefano and Rudra, Atri and R{\\'e}, Christopher},\n  booktitle={Advances in Neural Information Processing Systems (NeurIPS)},\n  year={2022}\n}\n@inproceedings{dao2023flashattention2,\n  title={Flash{A}ttention-2: Faster Attention with Better Parallelism and Work Partitioning},\n  author={Dao, Tri},\n  booktitle={International Conference on Learning Representations (ICLR)},\n  year={2024}\n}\n```\n",
  "external_links_in_readme": [
    "https://mistral.ai/news/announcing-mistral-7b/",
    "https://github.com/Dao-AILab/flash-attention/tree/main/training",
    "https://tridao.me/blog/2024/flash3/",
    "https://spectrum.ieee.org/mlperf-rankings-2022",
    "https://github.com/openai/triton/blob/master/python/tutorials/06-fused-attention.py",
    "https://hub.docker.com/r/rocm/pytorch",
    "https://mistral.ai/",
    "https://tridao.me/publications/flash2/flash2.pdf",
    "https://arxiv.org/abs/2205.14135",
    "https://tridao.me/publications/flash3/flash3.pdf",
    "https://github.com/triton-lang/triton",
    "https://github.com/Dao-AILab/flash-attention/issues/595",
    "https://github.com/ROCm/composable_kernel",
    "https://arxiv.org/abs/2309.06180",
    "https://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/modules/mha.py",
    "https://github.com/Dao-AILab/flash-attention/blob/main/usage.md",
    "https://github.com/ROCm/flash-attention.git",
    "https://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/flash_attn_triton.py",
    "https://github.com/Dao-AILab/flash-attention/blob/main/flash_attn/models/gpt.py",
    "https://catalog.ngc.nvidia.com/orgs/nvidia/containers/pytorch"
  ]
}
```

</details>


---

## Repository 2: UKPLab/sentence-transformers

# GitHub Repository Data

**Repository:** [UKPLab/sentence-transformers](https://github.com/UKPLab/sentence-transformers)

## Basic Information

- **Description:** State-of-the-Art Text Embeddings
- **Created:** 2019-07-24T10:53:51+00:00
- **Last Updated:** 2025-06-21T13:14:53+00:00
- **Last Pushed:** 2025-06-11T10:18:41+00:00
- **Default Branch:** master
- **Size:** 21741 KB

## Statistics

- **Stars:** 16,966
- **Forks:** 2,621
- **Watchers:** 16,966
- **Open Issues:** 1,279
- **Total Issues:** 0
- **Pull Requests:** 717

## License

- **Type:** Apache License 2.0
- **SPDX ID:** Apache-2.0
- **URL:** [License](https://github.com/UKPLab/sentence-transformers/blob/master/LICENSE)

## Languages

- **Python:** 1,369,557 bytes
- **Makefile:** 509 bytes

## Top Contributors

1. **nreimers** - 1005 contributions
2. **tomaarsen** - 424 contributions
3. **milistu** - 18 contributions
4. **PhilipMay** - 17 contributions
5. **fpgmaas** - 16 contributions
6. **cpcdoy** - 14 contributions
7. **JINO-ROHIT** - 12 contributions
8. **osanseviero** - 11 contributions
9. **sidhantls** - 10 contributions
10. **kwang2049** - 7 contributions

## File Structure (Sample of 10 files)

Total files: 509

- `.github` (tree)
- `.github/workflows` (tree)
- `.github/workflows/quality.yml` (blob)
- `.github/workflows/tests.yml` (blob)
- `.gitignore` (blob)
- `.pre-commit-config.yaml` (blob)
- `LICENSE` (blob)
- `MANIFEST.in` (blob)
- `Makefile` (blob)
- `NOTICE.txt` (blob)

## Recent Issues

- 游릭 **#3400** Role of batch_size and mini_batch_size in CrossEncoder (open)
- 游릭 **#3399** Feature Request: Surfacing Token Level Attention Scores inside the `forward` pass of `Transformer` class. (open)
- 游릭 **#3398** [BUG] CrossEncoder with BGE Reranker V2-M3 giving all similarities as exactly 1 (open)
- 游릭 **#3397** Can't figure this out! TOKENIZATION FAILED: Unable to create tensor, you should probably activate truncation and/or padding... (open)
- 游릭 **#3396** `NotImplementedError:` Cannot copy out of meta tensor when loading model with PyTorch 2.2+ and SentenceTransformers 4.1.0 (open)

## Recent Pull Requests

- 游댮 **#3391** [`tests`] Improve robustness of model shape assertion in model2vec test (closed)
- 游릭 **#3385** Move precision validation before embedding computation (open)
- 游댮 **#3379** Correcting TripletEvaluator.py Docstring (closed)
- 游댮 **#3376** Minor change to docs, ordering of operations was off by one. (closed)
- 游댮 **#3374** Propagate local_files_only to model card to avoid verifying dataset/base model (closed)

## Recent Commits

- **910ed144** Improve robustness of model shape assertion in model2vec test (#3391) - Tom Aarsen (2025-06-11T10:18:41+00:00)
- **20a22488** feature - mine hard negatives working with prompts (#3334) - Giovanni Alzetta, PhD (2025-06-11T09:03:45+00:00)
- **9b571054** Update sign in TripletEvaluator documentation (#3379) - John Eckberg (2025-06-11T08:52:47+00:00)
- **deb8e8d3** Propagate local_files_only to model card to avoid verifying dataset/base model (#3374) - Tom Aarsen (2025-06-04T07:49:26+00:00)
- **163258f1** fix: device name in multi-node ddp (#3373) - sasakiyori (2025-05-23T09:31:40+00:00)
- **92de7b06** Allow passing a custom batch sampler to the trainer (#3162) - alm (2025-05-23T08:51:45+00:00)
- **5add8c4a** Add embedding cache mechanism to avoid redundant recomputation (#3338) - daegon Yu (2025-05-23T08:50:52+00:00)
- **6551017b** Add OpenSearch-based semantic search example (#3369) - zhichao-aws (2025-05-23T08:42:00+00:00)
- **dd8a8d7d** HF tokenizer support for WordEmbeddings module (#3362) - talbaumel (2025-05-14T15:22:26+00:00)
- **f3dad376** Reload all modules when loading the best saved checkpoint, not just the transformer one (#3360) - Tom Aarsen (2025-05-14T10:32:30+00:00)

## External Links Found in README

- https://www.sbert.net/examples/sentence_transformer/applications/paraphrase-mining/README.html
- https://img.shields.io/badge/%F0%9F%A4%97-models-yellow
- https://pypi.org/project/sentence-transformers/
- https://arxiv.org/abs/1908.10084
- https://sbert.net/docs/quickstart.html#sentence-transformer
- https://github.com/huggingface/transformers
- https://www.sbert.net/docs/package_reference/sentence_transformer/losses.html
- https://www.sbert.net/examples/sentence_transformer/applications/clustering/README.html
- https://www.sbert.net/docs/sentence_transformer/training_overview.html
- https://www.sbert.net/examples/sentence_transformer/applications/image-search/README.html
- https://img.shields.io/pypi/pyversions/sentence-transformers?logo=pypi&style=flat&color=blue
- https://www.sbert.net/docs/usage/semantic_textual_similarity.html
- https://github.com/UKPLab/sentence-transformers
- https://github.com/UKPLab/sentence-transformers/blob/master/LICENSE
- https://www.sbert.net/docs/package_reference/cross_encoder/losses.html
- https://arxiv.org/abs/2004.09813",
- https://github.com/UKPLab/sentence-transformers/tree/master/examples/cross_encoder/training
- https://anaconda.org/conda-forge/sentence-transformers
- https://www.sbert.net/docs/cross_encoder/training_overview.html
- https://www.sbert.net/examples/sentence_transformer/applications/computing-embeddings/README.html

## Raw Data

<details>
<summary>Click to expand raw JSON data</summary>

```json
{
  "id": 198616978,
  "name": "sentence-transformers",
  "full_name": "UKPLab/sentence-transformers",
  "description": "State-of-the-Art Text Embeddings",
  "html_url": "https://github.com/UKPLab/sentence-transformers",
  "clone_url": "https://github.com/UKPLab/sentence-transformers.git",
  "ssh_url": "git@github.com:UKPLab/sentence-transformers.git",
  "homepage": "https://www.sbert.net",
  "topics": [],
  "default_branch": "master",
  "created_at": "2019-07-24T10:53:51+00:00",
  "updated_at": "2025-06-21T13:14:53+00:00",
  "pushed_at": "2025-06-11T10:18:41+00:00",
  "size_kb": 21741,
  "watchers_count": 16966,
  "stargazers_count": 16966,
  "forks_count": 2621,
  "open_issues_count": 1279,
  "license": {
    "key": "apache-2.0",
    "name": "Apache License 2.0",
    "spdx_id": "Apache-2.0",
    "url": "https://github.com/UKPLab/sentence-transformers/blob/master/LICENSE"
  },
  "languages": {
    "Python": 1369557,
    "Makefile": 509
  },
  "top_contributors": [
    {
      "login": "nreimers",
      "contributions": 1005
    },
    {
      "login": "tomaarsen",
      "contributions": 424
    },
    {
      "login": "milistu",
      "contributions": 18
    },
    {
      "login": "PhilipMay",
      "contributions": 17
    },
    {
      "login": "fpgmaas",
      "contributions": 16
    },
    {
      "login": "cpcdoy",
      "contributions": 14
    },
    {
      "login": "JINO-ROHIT",
      "contributions": 12
    },
    {
      "login": "osanseviero",
      "contributions": 11
    },
    {
      "login": "sidhantls",
      "contributions": 10
    },
    {
      "login": "kwang2049",
      "contributions": 7
    },
    {
      "login": "kddubey",
      "contributions": 7
    },
    {
      "login": "michaelfeil",
      "contributions": 6
    },
    {
      "login": "pesuchin",
      "contributions": 6
    },
    {
      "login": "fros1y",
      "contributions": 5
    },
    {
      "login": "ArthurCamara",
      "contributions": 5
    },
    {
      "login": "andrewkittredge",
      "contributions": 4
    },
    {
      "login": "fkdosilovic",
      "contributions": 4
    },
    {
      "login": "johneckberg",
      "contributions": 4
    },
    {
      "login": "josemarcosrf",
      "contributions": 3
    },
    {
      "login": "aphedges",
      "contributions": 3
    }
  ],
  "file_tree_count": 509,
  "file_tree_sample": [
    {
      "path": ".github",
      "type": "tree"
    },
    {
      "path": ".github/workflows",
      "type": "tree"
    },
    {
      "path": ".github/workflows/quality.yml",
      "type": "blob"
    },
    {
      "path": ".github/workflows/tests.yml",
      "type": "blob"
    },
    {
      "path": ".gitignore",
      "type": "blob"
    },
    {
      "path": ".pre-commit-config.yaml",
      "type": "blob"
    },
    {
      "path": "LICENSE",
      "type": "blob"
    },
    {
      "path": "MANIFEST.in",
      "type": "blob"
    },
    {
      "path": "Makefile",
      "type": "blob"
    },
    {
      "path": "NOTICE.txt",
      "type": "blob"
    }
  ],
  "issues_count": 0,
  "pulls_count": 717,
  "recent_issues": [
    {
      "number": 3400,
      "title": "Role of batch_size and mini_batch_size in CrossEncoder",
      "state": "open"
    },
    {
      "number": 3399,
      "title": "Feature Request: Surfacing Token Level Attention Scores inside the `forward` pass of `Transformer` class.",
      "state": "open"
    },
    {
      "number": 3398,
      "title": "[BUG] CrossEncoder with BGE Reranker V2-M3 giving all similarities as exactly 1",
      "state": "open"
    },
    {
      "number": 3397,
      "title": "Can't figure this out! TOKENIZATION FAILED: Unable to create tensor, you should probably activate truncation and/or padding...",
      "state": "open"
    },
    {
      "number": 3396,
      "title": "`NotImplementedError:` Cannot copy out of meta tensor when loading model with PyTorch 2.2+ and SentenceTransformers 4.1.0",
      "state": "open"
    }
  ],
  "recent_pulls": [
    {
      "number": 3391,
      "title": "[`tests`] Improve robustness of model shape assertion in model2vec test",
      "state": "closed"
    },
    {
      "number": 3385,
      "title": "Move precision validation before embedding computation",
      "state": "open"
    },
    {
      "number": 3379,
      "title": "Correcting TripletEvaluator.py Docstring",
      "state": "closed"
    },
    {
      "number": 3376,
      "title": "Minor change to docs, ordering of operations was off by one.",
      "state": "closed"
    },
    {
      "number": 3374,
      "title": "Propagate local_files_only to model card to avoid verifying dataset/base model",
      "state": "closed"
    }
  ],
  "recent_commits": [
    {
      "sha": "910ed144dfc0a08f31517b0d01580302015fa408",
      "author": "Tom Aarsen",
      "date": "2025-06-11T10:18:41+00:00",
      "message": "Improve robustness of model shape assertion in model2vec test (#3391)"
    },
    {
      "sha": "20a22488376f8be11691302d829b1aa641413a69",
      "author": "Giovanni Alzetta, PhD",
      "date": "2025-06-11T09:03:45+00:00",
      "message": "feature - mine hard negatives working with prompts (#3334)"
    },
    {
      "sha": "9b571054a0c870c3bdc8b9af197fc0b79ed55fe9",
      "author": "John Eckberg",
      "date": "2025-06-11T08:52:47+00:00",
      "message": "Update sign in TripletEvaluator documentation (#3379)"
    },
    {
      "sha": "deb8e8d3b74d99645686a8760c7ca459b38a5582",
      "author": "Tom Aarsen",
      "date": "2025-06-04T07:49:26+00:00",
      "message": "Propagate local_files_only to model card to avoid verifying dataset/base model (#3374)"
    },
    {
      "sha": "163258f16cc0fa75639fd6e2b58bdc42921178f0",
      "author": "sasakiyori",
      "date": "2025-05-23T09:31:40+00:00",
      "message": "fix: device name in multi-node ddp (#3373)"
    },
    {
      "sha": "92de7b06d772b0e7a5a19b806d57098ea3489fac",
      "author": "alm",
      "date": "2025-05-23T08:51:45+00:00",
      "message": "Allow passing a custom batch sampler to the trainer (#3162)"
    },
    {
      "sha": "5add8c4afca2a0f8ddecb1c83fe5c1b815bc939c",
      "author": "daegon Yu",
      "date": "2025-05-23T08:50:52+00:00",
      "message": "Add embedding cache mechanism to avoid redundant recomputation (#3338)"
    },
    {
      "sha": "6551017b85510bd032300eed22ac399ce21dd9cd",
      "author": "zhichao-aws",
      "date": "2025-05-23T08:42:00+00:00",
      "message": "Add OpenSearch-based semantic search example (#3369)"
    },
    {
      "sha": "dd8a8d7d4d5660e7b2b69e8a1ece8202417c0069",
      "author": "talbaumel",
      "date": "2025-05-14T15:22:26+00:00",
      "message": "HF tokenizer support for WordEmbeddings module (#3362)"
    },
    {
      "sha": "f3dad37614c779ab32084f0ee7b4c40ed630cecb",
      "author": "Tom Aarsen",
      "date": "2025-05-14T10:32:30+00:00",
      "message": "Reload all modules when loading the best saved checkpoint, not just the transformer one (#3360)"
    },
    {
      "sha": "15077c752fa537a70e5a806fbbbbf0debb01d239",
      "author": "Stephan Tulkens",
      "date": "2025-05-14T10:32:19+00:00",
      "message": "feat: expose new model2vec parameters (#3349)"
    },
    {
      "sha": "68a61ec8e8f0497e5cddc0bc59f92b82ef62b54d",
      "author": "Tom Aarsen",
      "date": "2025-05-08T14:06:04+00:00",
      "message": "[`refactor`] Refactor module loading; introduce Module subclass (#3345)"
    },
    {
      "sha": "5362a8a19a22aba3f689e98a612c34e2fe4869b5",
      "author": "Tom Aarsen",
      "date": "2025-05-08T14:05:48+00:00",
      "message": "Add two useful recommendations to the docs (#3353)"
    },
    {
      "sha": "6eb95f1804854424345ee6a919ef154b5303e324",
      "author": "Tom Aarsen",
      "date": "2025-05-08T13:12:06+00:00",
      "message": "[`tests`] Update test based on M2V version (#3354)"
    },
    {
      "sha": "f604a9e60c744d4f871477517598fab4b33406ae",
      "author": "Hiroki Iida",
      "date": "2025-04-24T11:02:26+00:00",
      "message": "[fix]  add dtype propetry for fsdp2 (#3337)"
    },
    {
      "sha": "72570581fde6448c0142bc1144ce93ab406d345f",
      "author": "Shachar Mirkin",
      "date": "2025-04-23T10:15:53+00:00",
      "message": "Fix broken links in docs (#3340)"
    },
    {
      "sha": "e0d08a2dab0e6b77b748df9e89669cafc1cc3a57",
      "author": "Tom Aarsen",
      "date": "2025-04-22T15:56:57+00:00",
      "message": "[`cross-encoder`] Propagate the gradient checkpointing to the transformer model (#3331)"
    },
    {
      "sha": "5c15ba1ae957fd86373c50d3c254071c858ef4e2",
      "author": "Tom Aarsen",
      "date": "2025-04-22T14:14:17+00:00",
      "message": "[`ci`] Attempt to avoid 429 Client Error in CI (#3342)"
    },
    {
      "sha": "71d12d6055292e98abbfcaf4c4e90c81d5766501",
      "author": "Tom Aarsen",
      "date": "2025-04-15T13:47:59+00:00",
      "message": "Increment dev version to 4.2.0.dev0"
    },
    {
      "sha": "086d34586e342ccc7e00ef8bb4f3a128637c90e7",
      "author": "Tom Aarsen",
      "date": "2025-04-15T13:37:10+00:00",
      "message": "Point to v4.1 new docs pages in index.html (#3328)"
    }
  ],
  "readme_text": "<!--- BADGES: START --->\n[![HF Models](https://img.shields.io/badge/%F0%9F%A4%97-models-yellow)](https://huggingface.co/models?library=sentence-transformers)\n[![GitHub - License](https://img.shields.io/github/license/UKPLab/sentence-transformers?logo=github&style=flat&color=green)][#github-license]\n[![PyPI - Python Version](https://img.shields.io/pypi/pyversions/sentence-transformers?logo=pypi&style=flat&color=blue)][#pypi-package]\n[![PyPI - Package Version](https://img.shields.io/pypi/v/sentence-transformers?logo=pypi&style=flat&color=orange)][#pypi-package]\n[![Docs - GitHub.io](https://img.shields.io/static/v1?logo=github&style=flat&color=pink&label=docs&message=sentence-transformers)][#docs-package]\n<!-- [![PyPI - Downloads](https://img.shields.io/pypi/dm/sentence-transformers?logo=pypi&style=flat&color=green)][#pypi-package] -->\n\n[#github-license]: https://github.com/UKPLab/sentence-transformers/blob/master/LICENSE\n[#pypi-package]: https://pypi.org/project/sentence-transformers/\n[#conda-forge-package]: https://anaconda.org/conda-forge/sentence-transformers\n[#docs-package]: https://www.sbert.net/\n<!--- BADGES: END --->\n\n# Sentence Transformers: Embeddings, Retrieval, and Reranking\n\nThis framework provides an easy method to compute embeddings for accessing, using, and training state-of-the-art embedding and reranker models. It compute embeddings using Sentence Transformer models ([quickstart](https://sbert.net/docs/quickstart.html#sentence-transformer)) or to calculate similarity scores using Cross-Encoder (a.k.a. reranker) models ([quickstart](https://sbert.net/docs/quickstart.html#cross-encoder)). This unlocks a wide range of applications, including [semantic search](https://sbert.net/examples/applications/semantic-search/README.html), [semantic textual similarity](https://sbert.net/docs/sentence_transformer/usage/semantic_textual_similarity.html), and [paraphrase mining](https://sbert.net/examples/applications/paraphrase-mining/README.html).\n\nA wide selection of over [10,000 pre-trained Sentence Transformers models](https://huggingface.co/models?library=sentence-transformers) are available for immediate use on \ud83e\udd17 Hugging Face, including many of the state-of-the-art models from the [Massive Text Embeddings Benchmark (MTEB) leaderboard](https://huggingface.co/spaces/mteb/leaderboard). Additionally, it is easy to train or finetune your own [embedding models](https://sbert.net/docs/sentence_transformer/training_overview.html) or [reranker models](https://sbert.net/docs/cross_encoder/training_overview.html) using Sentence Transformers, enabling you to create custom models for your specific use cases.\n\nFor the **full documentation**, see **[www.SBERT.net](https://www.sbert.net)**.\n\n## Installation\n\nWe recommend **Python 3.9+**, **[PyTorch 1.11.0+](https://pytorch.org/get-started/locally/)**, and **[transformers v4.34.0+](https://github.com/huggingface/transformers)**.\n\n**Install with pip**\n\n```\npip install -U sentence-transformers\n```\n\n**Install with conda**\n\n```\nconda install -c conda-forge sentence-transformers\n```\n\n**Install from sources**\n\nAlternatively, you can also clone the latest version from the [repository](https://github.com/UKPLab/sentence-transformers) and install it directly from the source code:\n\n````\npip install -e .\n```` \n\n**PyTorch with CUDA**\n\nIf you want to use a GPU / CUDA, you must install PyTorch with the matching CUDA Version. Follow\n[PyTorch - Get Started](https://pytorch.org/get-started/locally/) for further details how to install PyTorch.\n\n## Getting Started\n\nSee [Quickstart](https://www.sbert.net/docs/quickstart.html) in our documentation.\n\n### Embedding Models\n\nFirst download a pretrained embedding a.k.a. Sentence Transformer model.\n\n````python\nfrom sentence_transformers import SentenceTransformer\n\nmodel = SentenceTransformer(\"all-MiniLM-L6-v2\")\n````\n\nThen provide some texts to the model.\n\n````python\nsentences = [\n    \"The weather is lovely today.\",\n    \"It's so sunny outside!\",\n    \"He drove to the stadium.\",\n]\nembeddings = model.encode(sentences)\nprint(embeddings.shape)\n# => (3, 384)\n````\n\nAnd that's already it. We now have a numpy arrays with the embeddings, one for each text. We can use these to compute similarities.\n\n````python\nsimilarities = model.similarity(embeddings, embeddings)\nprint(similarities)\n# tensor([[1.0000, 0.6660, 0.1046],\n#         [0.6660, 1.0000, 0.1411],\n#         [0.1046, 0.1411, 1.0000]])\n````\n\n### Reranker Models\n\nFirst download a pretrained reranker a.k.a. Cross Encoder model.\n\n```python\nfrom sentence_transformers import CrossEncoder\n\n# 1. Load a pretrained CrossEncoder model\nmodel = CrossEncoder(\"cross-encoder/ms-marco-MiniLM-L6-v2\")\n```\n\nThen provide some texts to the model.\n\n```python\n# The texts for which to predict similarity scores\nquery = \"How many people live in Berlin?\"\npassages = [\n    \"Berlin had a population of 3,520,031 registered inhabitants in an area of 891.82 square kilometers.\",\n    \"Berlin has a yearly total of about 135 million day visitors, making it one of the most-visited cities in the European Union.\",\n    \"In 2013 around 600,000 Berliners were registered in one of the more than 2,300 sport and fitness clubs.\",\n]\n\n# 2a. predict scores pairs of texts\nscores = model.predict([(query, passage) for passage in passages])\nprint(scores)\n# => [8.607139 5.506266 6.352977]\n```\n\nAnd we're good to go. You can also use [`model.rank`](https://sbert.net/docs/package_reference/cross_encoder/cross_encoder.html#sentence_transformers.cross_encoder.CrossEncoder.rank) to avoid having to perform the reranking manually:\n\n```python\n# 2b. Rank a list of passages for a query\nranks = model.rank(query, passages, return_documents=True)\n\nprint(\"Query:\", query)\nfor rank in ranks:\n    print(f\"- #{rank['corpus_id']} ({rank['score']:.2f}): {rank['text']}\")\n\"\"\"\nQuery: How many people live in Berlin?\n- #0 (8.61): Berlin had a population of 3,520,031 registered inhabitants in an area of 891.82 square kilometers.\n- #2 (6.35): In 2013 around 600,000 Berliners were registered in one of the more than 2,300 sport and fitness clubs.\n- #1 (5.51): Berlin has a yearly total of about 135 million day visitors, making it one of the most-visited cities in the European Union.\n\"\"\"\n```\n\n## Pre-Trained Models\n\nWe provide a large list of pretrained models for more than 100 languages. Some models are general purpose models, while others produce embeddings for specific use cases. \n\n* [Pretrained Sentence Transformer (Embedding) Models](https://sbert.net/docs/sentence_transformer/pretrained_models.html)\n* [Pretrained Cross Encoder (Reranker) Models](https://sbert.net/docs/cross_encoder/pretrained_models.html)\n\n## Training\n\nThis framework allows you to fine-tune your own sentence embedding methods, so that you get task-specific sentence embeddings. You have various options to choose from in order to get perfect sentence embeddings for your specific task. \n\n* Embedding Models\n    * [Sentence Transformer > Training Overview](https://www.sbert.net/docs/sentence_transformer/training_overview.html)\n    * [Sentence Transformer > Training Examples](https://www.sbert.net/docs/sentence_transformer/training/examples.html) or [training examples on GitHub](https://github.com/UKPLab/sentence-transformers/tree/master/examples/sentence_transformer/training).\n* Reranker Models\n    * [Cross Encoder > Training Overview](https://www.sbert.net/docs/cross_encoder/training_overview.html)\n    * [Cross Encoder > Training Examples](https://www.sbert.net/docs/cross_encoder/training/examples.html) or [training examples on GitHub](https://github.com/UKPLab/sentence-transformers/tree/master/examples/cross_encoder/training).\n\nSome highlights across both types of training are:\n- Support of various transformer networks including BERT, RoBERTa, XLM-R, DistilBERT, Electra, BART, ...\n- Multi-Lingual and multi-task learning\n- Evaluation during training to find optimal model\n- [20+ loss functions](https://www.sbert.net/docs/package_reference/sentence_transformer/losses.html) for embedding models and [10+ loss functions](https://www.sbert.net/docs/package_reference/cross_encoder/losses.html) for reranker models, allowing you to tune models specifically for semantic search, paraphrase mining, semantic similarity comparison, clustering, triplet loss, contrastive loss, etc.\n\n## Application Examples\n\nYou can use this framework for:\n\n- [Computing Sentence Embeddings](https://www.sbert.net/examples/sentence_transformer/applications/computing-embeddings/README.html)\n- [Semantic Textual Similarity](https://www.sbert.net/docs/usage/semantic_textual_similarity.html)\n- [Semantic Search](https://www.sbert.net/examples/sentence_transformer/applications/semantic-search/README.html)\n- [Retrieve & Re-Rank](https://www.sbert.net/examples/sentence_transformer/applications/retrieve_rerank/README.html) \n- [Clustering](https://www.sbert.net/examples/sentence_transformer/applications/clustering/README.html)\n- [Paraphrase Mining](https://www.sbert.net/examples/sentence_transformer/applications/paraphrase-mining/README.html)\n- [Translated Sentence Mining](https://www.sbert.net/examples/sentence_transformer/applications/parallel-sentence-mining/README.html)\n- [Multilingual Image Search, Clustering & Duplicate Detection](https://www.sbert.net/examples/sentence_transformer/applications/image-search/README.html)\n\nand many more use-cases.\n\nFor all examples, see [examples/sentence_transformer/applications](https://github.com/UKPLab/sentence-transformers/tree/master/examples/sentence_transformer/applications).\n\n## Development setup\n\nAfter cloning the repo (or a fork) to your machine, in a virtual environment, run:\n\n```\npython -m pip install -e \".[dev]\"\n\npre-commit install\n```\n\nTo test your changes, run:\n\n```\npytest\n```\n\n## Citing & Authors\n\nIf you find this repository helpful, feel free to cite our publication [Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks](https://arxiv.org/abs/1908.10084):\n\n```bibtex \n@inproceedings{reimers-2019-sentence-bert,\n    title = \"Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks\",\n    author = \"Reimers, Nils and Gurevych, Iryna\",\n    booktitle = \"Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing\",\n    month = \"11\",\n    year = \"2019\",\n    publisher = \"Association for Computational Linguistics\",\n    url = \"https://arxiv.org/abs/1908.10084\",\n}\n```\n\nIf you use one of the multilingual models, feel free to cite our publication [Making Monolingual Sentence Embeddings Multilingual using Knowledge Distillation](https://arxiv.org/abs/2004.09813):\n\n```bibtex\n@inproceedings{reimers-2020-multilingual-sentence-bert,\n    title = \"Making Monolingual Sentence Embeddings Multilingual using Knowledge Distillation\",\n    author = \"Reimers, Nils and Gurevych, Iryna\",\n    booktitle = \"Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing\",\n    month = \"11\",\n    year = \"2020\",\n    publisher = \"Association for Computational Linguistics\",\n    url = \"https://arxiv.org/abs/2004.09813\",\n}\n```\n\nPlease have a look at [Publications](https://www.sbert.net/docs/publications.html) for our different publications that are integrated into SentenceTransformers.\n\nMaintainer: [Tom Aarsen](https://github.com/tomaarsen), \ud83e\udd17 Hugging Face\n\nhttps://www.ukp.tu-darmstadt.de/\n\nDon't hesitate to open an issue if something is broken (and it shouldn't be) or if you have further questions.\n\n> This repository contains experimental software and is published for the sole purpose of giving additional background details on the respective publication.\n",
  "external_links_in_readme": [
    "https://www.sbert.net/examples/sentence_transformer/applications/paraphrase-mining/README.html",
    "https://img.shields.io/badge/%F0%9F%A4%97-models-yellow",
    "https://pypi.org/project/sentence-transformers/",
    "https://arxiv.org/abs/1908.10084",
    "https://sbert.net/docs/quickstart.html#sentence-transformer",
    "https://github.com/huggingface/transformers",
    "https://www.sbert.net/docs/package_reference/sentence_transformer/losses.html",
    "https://www.sbert.net/examples/sentence_transformer/applications/clustering/README.html",
    "https://www.sbert.net/docs/sentence_transformer/training_overview.html",
    "https://www.sbert.net/examples/sentence_transformer/applications/image-search/README.html",
    "https://img.shields.io/pypi/pyversions/sentence-transformers?logo=pypi&style=flat&color=blue",
    "https://www.sbert.net/docs/usage/semantic_textual_similarity.html",
    "https://github.com/UKPLab/sentence-transformers",
    "https://github.com/UKPLab/sentence-transformers/blob/master/LICENSE",
    "https://www.sbert.net/docs/package_reference/cross_encoder/losses.html",
    "https://arxiv.org/abs/2004.09813\",",
    "https://github.com/UKPLab/sentence-transformers/tree/master/examples/cross_encoder/training",
    "https://anaconda.org/conda-forge/sentence-transformers",
    "https://www.sbert.net/docs/cross_encoder/training_overview.html",
    "https://www.sbert.net/examples/sentence_transformer/applications/computing-embeddings/README.html",
    "https://sbert.net/examples/applications/semantic-search/README.html",
    "https://arxiv.org/abs/2004.09813",
    "https://sbert.net/docs/cross_encoder/pretrained_models.html",
    "https://www.sbert.net/docs/cross_encoder/training/examples.html",
    "https://www.sbert.net",
    "https://github.com/UKPLab/sentence-transformers/tree/master/examples/sentence_transformer/training",
    "https://arxiv.org/abs/1908.10084\",",
    "https://img.shields.io/pypi/v/sentence-transformers?logo=pypi&style=flat&color=orange",
    "https://www.sbert.net/examples/sentence_transformer/applications/retrieve_rerank/README.html",
    "https://www.sbert.net/",
    "https://github.com/UKPLab/sentence-transformers/tree/master/examples/sentence_transformer/applications",
    "https://www.sbert.net/docs/quickstart.html",
    "https://sbert.net/docs/quickstart.html#cross-encoder",
    "https://www.sbert.net/docs/publications.html",
    "https://github.com/tomaarsen",
    "https://img.shields.io/pypi/dm/sentence-transformers?logo=pypi&style=flat&color=green",
    "https://huggingface.co/spaces/mteb/leaderboard",
    "https://pytorch.org/get-started/locally/",
    "https://sbert.net/docs/cross_encoder/training_overview.html",
    "https://sbert.net/docs/package_reference/cross_encoder/cross_encoder.html#sentence_transformers.cross_encoder.CrossEncoder.rank",
    "https://www.sbert.net/examples/sentence_transformer/applications/parallel-sentence-mining/README.html",
    "https://huggingface.co/models?library=sentence-transformers",
    "https://www.sbert.net/docs/sentence_transformer/training/examples.html",
    "https://www.ukp.tu-darmstadt.de/",
    "https://www.sbert.net/examples/sentence_transformer/applications/semantic-search/README.html",
    "https://sbert.net/docs/sentence_transformer/usage/semantic_textual_similarity.html",
    "https://img.shields.io/github/license/UKPLab/sentence-transformers?logo=github&style=flat&color=green",
    "https://sbert.net/docs/sentence_transformer/pretrained_models.html",
    "https://sbert.net/examples/applications/paraphrase-mining/README.html",
    "https://sbert.net/docs/sentence_transformer/training_overview.html",
    "https://img.shields.io/static/v1?logo=github&style=flat&color=pink&label=docs&message=sentence-transformers"
  ]
}
```

</details>


---

